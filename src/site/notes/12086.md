---
{"dg-publish":true,"permalink":"/12086/"}
---


```
# 12086 money_gong_emperor

ctx.user.theme.data[K_ALL_DISK_DATA]初始数据如下，与bet无关：
theme_info：
	fg_level_1：聚宝盆1的状态（1-5）
	fg_level_2：聚宝盆2的状态（1-5）
	firecrackers：主屏幕爆竹点燃数量（初始为2，范围是1-17）
fg_info：0（显示剩余fg spin次数；总次数可通过聚宝盆状态字段计算，如有需要我也可以再添加一个字段记录total_fg_spins）
respin_info：0（记录respin信息，为0表示此时不处于respin）
mgb_info：0（记录mgb_bonus信息，为0表示此时不处于mgb_bonus）

win_info包含字段如下：
mode：当前类型，0/1/2/3分别表示base/fg/respin/mgb_bonus
theme_info
fg_info
respin_info
mgb_info
sym_changes：记录需要变化的图标信息，格式为[pos, sym]；pos范围为0-14
	当盘面落1-5个bn，锣可能额外补充bn到6个（可能为数字bn或mini/minor/maxi球），此时记为[pos, 14xx]/[pos, 17/18/19]（win_info返回的reel_info上该位置显示初始sym）
	特别的，当替换的原盘面sym组成了line win时，记为[pos, sym, 1]（可直接根据list长度判断，此时需要轮流出现两个图标）
	fg中锣可能额外给出w，此时记为[pos, 11]（win_info返回的reel_info上该位置显示初始sym）
sc_collect_info：初始为空，当有sc时不为空，记录各sc收集到哪个聚宝盆中，0/1/2分别表示左边/右边/两个。如[0,1,2]就表示盘面有3个sc，分别收集到左/右/两个聚宝盆
special_type：默认为0，为1表示下次中feature/bigwin且触发了概率播放的预告动画

[*注
base/fg中的图标均为int表示，不同倍数数字bn表示情况如下：
0.5   1401
1     1402
1.5   1403
2     1404
2.5   1405
4     1408
6     1412
8     1416
10    1420
（base/fg/respin/mgb的假轴中同样以该方式标注）
respin/mgb中只会出现0、bn、jp和mgb图标，为统一全部以list格式表示，将数字bn以[14, multi]的格式记录、jp/mgb记为[sym]（可判断是否为零，然后根据非零位置第一位进行配图，如为数字bn则添加金额数字）
暂定以8倍区分数字bn大/小（需要改变字体颜色）
]

reel_info：盘面信息（base/fg/respin中为3*5，mgb中为2*4）
base_win：base中赢钱，仅可能为way win
fg_win：fg中赢钱，仅可能为way win
win_ways
feature_win：respin赢钱，在spin数归0/填满时结算，不含mgb的赢钱数
bonus_win：mgb_bonus赢钱，在spin数归0/填满时结算

特别地：
respin_info： # 目前存的是变化后的盘面信息，需要根据extra_ball还原初始信息
	left_bets: 0
	spins：剩余spin次数，初始为3，落球重置
	nums：总落球个数，可用于判断添加激励动画
	extra_ball：本次spin触发的中屏锣信息，0表示不触发，一次spin最多触发一种
		[0, pos, type, parameter]表示触发prize boost，parameter表示金额倍数（由type为0/1区分加的是数字/jp，这部分后续会配一个假轴）
		[1, [[pos, multi], [pos, multi]...]]表示触发multiplier
		[2, pos, counts, times]表示触发repeat pays,counts为倍数，times为次数
		[3, pos]表示触发mgb球
	reel_show_info：盘面信息，也可直接用win_info中的reel_info
	mgb_pos：出现的mgb图标位置，用于将bonus_win金额显示在对应位置球上
	prize_num：本次respin中各类特殊奖励累计获得次数，与本次extra_ball信息一起用于确认锣的显示动效，初始为[0, 0, 0, 0]
	type：本次respin触发方式，1/2分别表示单次收集6个及以上bn/锣给球至6个触发，可用于确定是否播放中奖时播炮竹炸掉的动画
	multi_list：[[pos1, multi1], [pos2, multi2]...]
	multi_list_origin：[[pos1, multi1], [pos2, multi2]...]
	
mgb_info：
	patch：[当前mgb计算进度，总mgb个数]
		如[1,1]表示respin盘面一共有1个mgb，当前在第一个mgb玩法中；
		[1,2]表示respin盘面一共有2个mgb，当前在第一个mgb玩法中
	spins：剩余spin次数，初始为3，落球重置
	nums：总落球个数，可用于判断添加激励动画
	reel_show_info：盘面信息，也可直接用win_info中的reel_info
	multi_list：[[pos1, multi1], [pos2, multi2]...]

注：
判断触发fg：
	mode = 0，且fg_info不为0（触发fg_info字段数量的fg spin）
判断触发respin：
	mode = 0/1，且respin_info不为0
判断触发mgb_bonus：
	mode = 2，且mgb_info不为0
（如不方便我可以添加tri_fg/tri_respin/tri_mgb字段）

图标：
H1 1
H2 2
H3 3
H4 4
H5 5

L1 6
L2 7
L3 8
L4 9
L5 10

W 11

SC 13
BN 14

MGB 16

MINI 17  10
MINOR 18 25
MAXI 19  50
MAJOR 20

```


**7.11协议会明确**
1、关于respin
1）中屏一共需要收集多少爆竹？16还是17（最后一个win爆竹也要收集吗）
2）收集bn时，是一个bn可能触发1/2组爆竹，还是一个盘面的bn一共可能触发1/2组爆竹？
2、关于fg
1）fg中“收集sc触发聚宝盆，进度重置”是什么情况？聚宝盆状态始终为5，收集到sc并触发时重置该盆表示的数目进度吗？
2）fg触发方式：单次收集1/2/3个sc，如何确定fg次数？
3）fg中是否会出现mgb
4）最多9个w是什么意思？锣有可能给盘面增加w吗？
5）fg中收集sc是一起收集还是单个收集？（看视频好像是一起，再确认一下）

gm进入respin时直接给一个mgb
额外添加的与maxi同等倍率的数字bn球（21）
mgb、jp、数字bn都算bn球，共同参与bn计数
一种需要考虑的情况：进respin后首次触发加钱玩法，此时必须保证存在数字bn（不能全是jp bn）

**8.5优化会**
1、sym_changes和respin中触发multi玩法时的extral_ball字段按正确收集顺序调整，前端按序依次显示即可
2、规避了sc一列落多个
3、规避了respin中multi玩法落在同一球

**8.6**
调整送奖303/304：
6个以上bn进respin
记录respin每次spin结束时赢钱，如果不足则落新球，为方便控制统一不给mgb
注意需要在倒数第一/二次（12/13次）进行额外判断，并一次补齐（最大给50倍jp，因此304需要在倒数第二次进行额外判断）

补充作弊代码：
分别在respin和mgb中下落获得四种jp球

**8.7**
补充作弊代码：
收集并触发左/右/两个聚宝盆升级
fg中锣额外给满9个w，且落在赢钱线图标上，测试动画效果

**8.8**
simulation调整（与策划沟通）：
补充显示信息：
respin中获得球数的分布情况
调整：
fg的freq可以调小一些、适当加大respin和mgb_spin触发概率、一个respin中约中2-3次玩法

预设进fg时的初始盘面（要求无win、无sc）

调整爆竹点燃逻辑：落bn随机触发1/2组，目的是使锣上的爆竹对称，即不是完全随机触发

假轴调整：
respin和mgb_spin假轴中加0
prize boost假轴增加jp